<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 xmlns:vm="using:HapticLibrary.ViewModels"
             x:Class="HapticLibrary.Views.LibraryPageView"
             x:DataType="vm:LibraryPageViewModel">

    <UserControl.Resources>
        <StaticResource x:Key="AppGradientBrush" ResourceKey="AppGradientBrush"/>
    </UserControl.Resources>

    <Grid RowDefinitions="Auto,*">
        <Border Grid.Row="0" Background="White" BorderBrush="#E9ECEF" BorderThickness="0,0,0,1" Padding="30,8" Height="65">
            <TextBlock Text="My Library" FontSize="28" FontWeight="SemiBold" Foreground="#1D1D1F" VerticalAlignment="Center"/>
        </Border>
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch">
            <StackPanel Margin="20" Spacing="30">
                <!-- Audio-Only Books Section -->
                <StackPanel Spacing="16">
                    <TextBlock Text="Audio-Only Books" 
                        FontSize="24" 
                        FontWeight="Medium" 
                        Foreground="#1D1D1F"/>
                    
                    <ItemsControl ItemsSource="{Binding AudioOnlyBooks}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="3" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Background="Transparent"
                                    BorderThickness="0"
                                    Padding="12"
                                    Command="{Binding ClickCommand}"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"
                                    Cursor="Hand">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover Border">
                                            <Setter Property="RenderTransform" Value="scale(1.02)"/>
                                        </Style>
                                    </Button.Styles>
                                    
                                    <Border Background="White" 
                                        CornerRadius="16" 
                                        BoxShadow="0 2 12 0 #08000000"
                                        ClipToBounds="True"
                                        Width="280"
                                        Height="360"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Top">
                                        
                                        <Grid>
                                            <!-- Colored Left Border -->
                                            <Border Width="4" 
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Stretch"
                                                Margin="0,0,0,0"
                                                Background="#007AFF"/> <!-- Blue for Audio-Only -->
                                            
                                            <!-- Content -->
                                            <StackPanel Margin="20,24,20,24" 
                                                Spacing="16" 
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top">
                                                <!-- Book Cover -->
                                                <Border CornerRadius="8" 
                                                    ClipToBounds="True" 
                                                    Width="168" 
                                                    Height="240"
                                                    HorizontalAlignment="Center"
                                                    BoxShadow="0 2 8 0 #15000000"
                                                    Background="#F5F5F7">
                                                    <Grid>
                                                        <!-- F451 Book Cover -->
                                                        <Image Source="avares://HapticLibrary/Assets/Fahrenheit_451_Cover.jpg" 
                                                            Stretch="UniformToFill"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Width="168"
                                                            Height="240"
                                                            IsVisible="{Binding BookId, Converter={x:Static vm:F451VisibilityConverter.Instance}}"/>
                                                        
                                                        <!-- Placeholder for other books -->
                                                        <Border Background="#E5E5EA" CornerRadius="8" Width="140" Height="200" IsVisible="{Binding BookId, Converter={x:Static vm:PlaceholderVisibilityConverter.Instance}}">
                                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                                <PathIcon Data="{StaticResource icon_book_placeholder}" Width="48" Height="48" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                                <TextBlock Text="Cover" FontSize="12" Foreground="#8E8E93" HorizontalAlignment="Center"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                
                                                <!-- Book Info -->
                                                <StackPanel Spacing="4" 
                                                    HorizontalAlignment="Center"
                                                    Height="80"
                                                    VerticalAlignment="Top">
                                                    <TextBlock Text="{Binding Title}" 
                                                        FontSize="18" 
                                                        FontWeight="Medium" 
                                                        Foreground="#1D1D1F" 
                                                        TextWrapping="Wrap"
                                                        TextAlignment="Center"
                                                        MaxLines="2"
                                                        Height="44"/>
                                                    
                                                    <TextBlock Text="{Binding Author}" 
                                                        FontSize="14" 
                                                        Foreground="#86868B"
                                                        TextAlignment="Center"
                                                        Height="20"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- Read-Aloud Books Section -->
                <StackPanel Spacing="16">
                    <TextBlock Text="Read-Aloud Books" 
                        FontSize="24" 
                        FontWeight="Medium" 
                        Foreground="#1D1D1F"/>
                    
                    <ItemsControl ItemsSource="{Binding ReadAloudBooks}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="3" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Background="Transparent"
                                    BorderThickness="0"
                                    Padding="12"
                                    Command="{Binding ClickCommand}"
                                    HorizontalContentAlignment="Stretch"
                                    VerticalContentAlignment="Stretch"
                                    Cursor="Hand">
                                    <Button.Styles>
                                        <Style Selector="Button:pointerover Border">
                                            <Setter Property="RenderTransform" Value="scale(1.02)"/>
                                        </Style>
                                    </Button.Styles>
                                    
                                    <Border Background="White" 
                                        CornerRadius="16" 
                                        BoxShadow="0 2 12 0 #08000000"
                                        ClipToBounds="True"
                                        Width="280"
                                        Height="360"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Top">
                                        
                                        <Grid>
                                            <!-- Colored Left Border -->
                                            <Border Width="4" 
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Stretch"
                                                Margin="0,0,0,0"
                                                Background="{StaticResource AppGradientBrush}"/> <!-- Gradient for Read-Aloud -->
                                            
                                            <!-- Content -->
                                            <StackPanel Margin="20,24,20,24" 
                                                Spacing="16" 
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Top">
                                                <!-- Book Cover -->
                                                <Border CornerRadius="8" 
                                                    ClipToBounds="True" 
                                                    Width="168" 
                                                    Height="240"
                                                    HorizontalAlignment="Center"
                                                    BoxShadow="0 2 8 0 #15000000"
                                                    Background="#F5F5F7">
                                                    <Grid>
                                                        <!-- Lorax Book Cover -->
                                                        <Image Source="avares://HapticLibrary/Assets/TheLoraxCover.jpg" 
                                                            Stretch="UniformToFill"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Width="168"
                                                            Height="240"
                                                            IsVisible="{Binding BookId, Converter={x:Static vm:LoraxVisibilityConverter.Instance}}"/>
                                                        
                                                        <!-- Placeholder for other books -->
                                                        <Border Background="#E5E5EA" CornerRadius="8" Width="140" Height="200" IsVisible="{Binding BookId, Converter={x:Static vm:PlaceholderVisibilityConverter.Instance}}">
                                                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                                <PathIcon Data="{StaticResource icon_book_placeholder}" Width="48" Height="48" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                                                <TextBlock Text="Cover" FontSize="12" Foreground="#8E8E93" HorizontalAlignment="Center"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </Grid>
                                                </Border>
                                                
                                                <!-- Book Info -->
                                                <StackPanel Spacing="4" 
                                                    HorizontalAlignment="Center"
                                                    Height="80"
                                                    VerticalAlignment="Top">
                                                    <TextBlock Text="{Binding Title}" 
                                                        FontSize="18" 
                                                        FontWeight="Medium" 
                                                        Foreground="#1D1D1F" 
                                                        TextWrapping="Wrap"
                                                        TextAlignment="Center"
                                                        MaxLines="2"
                                                        Height="44"/>
                                                    
                                                    <TextBlock Text="{Binding Author}" 
                                                        FontSize="14" 
                                                        Foreground="#86868B"
                                                        TextAlignment="Center"
                                                        Height="20"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </Button>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
