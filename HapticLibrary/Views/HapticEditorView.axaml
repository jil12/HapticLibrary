<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:vm="using:HapticLibrary.ViewModels"
			 xmlns:m="using:HapticLibrary.Models"
			 xmlns:converters="using:HapticLibrary.Converters"
			 mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 x:DataType="vm:HapticEditorViewModel"
             x:Class="HapticLibrary.Views.HapticEditorView"
			 x:Name="HapticEditor">
	<UserControl.Resources>
		<converters:DrawingColorToBrushConverter x:Key="ColorBrushConverter"/>
		<converters:EditorWordToBrushConverter x:Key="EditorWordToBrushConverter"/>
		<converters:EditorWordToContrastForegroundConverter x:Key="EditorWordToContrastForegroundConverter"/>
	</UserControl.Resources>
	
	<Grid ColumnDefinitions="5*, 1*">
			<Grid Grid.Column="0"
				  RowDefinitions="auto, 3*, 1*">
				<Grid ColumnDefinitions="auto, auto"
					Background="Gray">
					<Button Grid.Column="0"
						Margin="10,5,0,0"
							Content="Export Book"
							Background="White"
							Foreground="Black"
							Command="{Binding ExportBookCommand}"/>
					<Button Grid.Column="1"
						Margin="0,5,0,0"
							Content="New Page"
							Background="White"
							Foreground="Black"
							Command="{Binding NewPageCommand}"/>
				</Grid>
				<Panel Grid.Row="1"
					   Background="Gray">
					<Grid ColumnDefinitions="auto, *, auto"
						HorizontalAlignment="Center" VerticalAlignment="Center">
						<Button
							Grid.Column="0"
							HorizontalAlignment="Right"
							Content="&lt;"
							Command="{Binding PrevPageCommand}"/>
						<Panel Grid.Column="1"
							Margin="100,60,100,60" Background="White"
						    Width="500"
						    Height="300">
							<ItemsControl ItemsSource="{Binding Words}">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<WrapPanel HorizontalAlignment="Center"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>

								<ItemsControl.ItemTemplate>
									<DataTemplate x:DataType="vm:EditorWordViewModel">
										<Button Content="{Binding Word}" Margin="2"
												Command="{Binding DataContext.SelectWordCommand, ElementName=HapticEditor}"
												CommandParameter="{Binding}"
												HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
												Foreground="{Binding, Converter={StaticResource EditorWordToContrastForegroundConverter}}"
												Background="{Binding, Converter={StaticResource EditorWordToBrushConverter}}">
											<Button.ContextMenu>

											</Button.ContextMenu>
										</Button>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</Panel>
						<Button
							Grid.Column="2"
							HorizontalAlignment="Left"
							Content="&gt;"
							Command="{Binding NextPageCommand}"/>
					</Grid>
				</Panel>
				<!-- Haptic Pattern Storage Panel -->
				<Panel Grid.Row="2" Background="BlueViolet">
					<StackPanel Margin="20, 10">
						<TextBlock Text="Haptic Patterns:" FontSize="16">
							
						</TextBlock>
						<ItemsControl ItemsSource="{Binding Patterns}"
									  Margin="0, 20">
							<ItemsControl.ItemsPanel>
								<ItemsPanelTemplate>
									<WrapPanel HorizontalAlignment="Left"/>
								</ItemsPanelTemplate>
							</ItemsControl.ItemsPanel>

							<ItemsControl.ItemTemplate>
								<DataTemplate x:DataType="m:HapticPattern">
									<Grid Width="60" Height="60" Margin="2">
										<Button Content="{Binding Name}"
											Command="{Binding DataContext.SelectPatternCommand, ElementName=HapticEditor}"
											CommandParameter="{Binding}"
											HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
											HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
											BorderThickness="0" Padding="0"
											Background="DarkGray">
										</Button>
										<Canvas HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
											<Ellipse Fill="{Binding Color, Converter={StaticResource ColorBrushConverter}}" Width="10" Height="10" Canvas.Right="10" Canvas.Bottom="5"/>
										</Canvas>
									</Grid>

								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</StackPanel>
				</Panel>
			</Grid>
		<!-- Haptic Properties Panel -->
		<Grid Grid.Column="1" RowDefinitions="auto, *">
			<Grid Grid.Row="0" ColumnDefinitions="auto, auto">
				<ToggleButton Grid.Column="0"
					Content="Pattern"
					IsChecked="{Binding IsPatternEditing}"
					Command="{Binding EnablePatternEditingCommand}"/>
				<ToggleButton Grid.Column="1"
					Content="Text"
					IsChecked="{Binding IsTextEditing}"
					Command="{Binding EnableTextEditingCommand}"/>
			</Grid>
			<Panel Grid.Row="1" Margin="10"
			IsVisible="{Binding IsPatternEditing}">
				<!-- Haptic Properties Panel -->
				<StackPanel   HorizontalAlignment="Left">
					<TextBlock HorizontalAlignment="Center"
							   FontSize="20"
							   TextWrapping="Wrap">Haptic Pattern Properties</TextBlock>
					<!-- Name Input -->
					<TextBlock Text="Name:"/>
					<TextBox Name="NameTextBox" Width="200" Text="{Binding HapticName}"/>

					<!-- Color Input -->
					<TextBlock Text="Color (R, G, B):"/>
					<StackPanel Orientation="Horizontal" Spacing="10">
						<TextBox Name="RedTextBox" Width="50"
								 Tag="0,255,HapticRed" TextInput="IntBox_TextInput" LostFocus="IntBox_OnLostFocus"/>
						<TextBox Name="GreenTextBox" Width="50"
								 Tag="0,255,HapticGreen" TextInput="IntBox_TextInput" LostFocus="IntBox_OnLostFocus"/>
						<TextBox Name="BlueTextBox" Width="50"
								 Tag="0,255,HapticBlue" TextInput="IntBox_TextInput" LostFocus="IntBox_OnLostFocus"/>
					</StackPanel>

					<!-- Temperature Input -->
					<TextBlock Text="Temperature (-1 to 1):"/>
					<TextBox Name="TemperatureTextBox" Width="200"
							 Tag="-1,1,HapticTemperature" TextInput="FloatBox_TextInput" LostFocus="FloatBox_OnLostFocus"/>

					<!-- Vibration Input -->
					<TextBlock Text="Vibration (0 to 1):"/>
					<TextBox Name="VibrationTextBox" Width="200"
							 Tag="0,1,HapticVibration" TextInput="FloatBox_TextInput" LostFocus="FloatBox_OnLostFocus"/>
				</StackPanel>
				<Button VerticalAlignment="Bottom" Command="{Binding CreateHapticPatternCommand}">
					Create Pattern
				</Button>
			</Panel>
			<Panel Grid.Row="1" Margin="10"
				   IsVisible="{Binding IsTextEditing}">
				<Grid RowDefinitions="auto, *, auto">
					<TextBlock Grid.Row="0"
							   Text="Edit Page"
							   FontSize="20"/>
					<TextBox Grid.Row="1"
							 Margin="0,20"
							 Text="{Binding EditableText}"/>
					<Button Grid.Row="2"
							VerticalAlignment="Bottom" Content="Update Text" Command="{Binding SaveTextCommand}"/>
				</Grid>
			</Panel>
		</Grid>
	</Grid>
</UserControl>
